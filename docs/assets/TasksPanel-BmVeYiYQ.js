import{j as e}from"./ui-vendor-KfDTkiq1.js";import{r}from"./react-vendor-IF54zLUS.js";import{c as W,u as Z,a5 as B,aY as $,aZ as V,l as U,a_ as ee,aO as se,a$ as te,b0 as ae,g as v,aL as Y,X as ne,Q as O,a6 as F,i as L,n as ie,j as re,b1 as oe,ah as le}from"./index-UwLtZcXk.js";import"./charts-PQtVkfgh.js";import"./backend-CX_x5MVl.js";import"./animations-CRFQTM8M.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=W("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function D(n){return n.filter(t=>!t.completed).map(t=>{const a=t.urgent?10:0,c=120,p=Math.min(t.estimatedMinutes,c),m=Math.max(0,30-p/c*30),h=t.userRating||5;let d=0;if(t.dueDate){const u=K(t.dueDate);u<=1?d=15:u<=3?d=10:u<=7&&(d=5)}const g=a+m+h+d,f=me(t,{urgencyScore:a,durationScore:m,interestScore:h,dueDateScore:d}),N=ue(t,g);return{...t,momentumScore:g,reasoning:f,encouragement:N}}).sort((t,a)=>a.momentumScore-t.momentumScore)}function de(n){return D(n).slice(0,3)}function _(n){return n===0?{xpBonus:0,streakMultiplier:1,message:"Start your momentum streak!"}:n>=10?{xpBonus:100,streakMultiplier:3,message:"ðŸ”¥ UNSTOPPABLE! 10+ tasks in a row!"}:n>=5?{xpBonus:50,streakMultiplier:2,message:"âš¡ ON FIRE! Keep the momentum going!"}:n>=3?{xpBonus:25,streakMultiplier:1.5,message:"ðŸ’ª Great momentum! You're crushing it!"}:{xpBonus:10,streakMultiplier:1.2,message:"âœ¨ Building momentum! Keep going!"}}function K(n){const o=new Date(n),t=new Date,a=o.getTime()-t.getTime();return Math.ceil(a/(1e3*60*60*24))}function me(n,o){const t=[];if(o.urgencyScore>0&&t.push("Marked as urgent"),n.estimatedMinutes<=15?t.push("Quick win (under 15 min)"):n.estimatedMinutes<=30&&t.push("Short task (under 30 min)"),n.userRating&&n.userRating>=8&&t.push("High interest level"),n.dueDate){const a=K(n.dueDate);a<=1?t.push("Due today/tomorrow"):a<=3&&t.push("Due this week")}return t.length===0?"Good task to tackle":t.join(" â€¢ ")}function ue(n,o){return n.estimatedMinutes<=5?"âš¡ Just 5 minutes! You got this!":n.estimatedMinutes<=15?"ðŸ’ª Quick win incoming! Let's do this!":n.urgent?"ðŸŽ¯ Time to crush this! You can handle it!":n.userRating&&n.userRating>=8?"âœ¨ This one sounds fun! Enjoy the process!":o>=50?"ðŸ”¥ Perfect task for right now! Go for it!":o>=30?"ðŸ‘ Good choice! You're building momentum!":"ðŸŒŸ One step at a time. You're doing great!"}function xe(n){const o=D(n);return{immediate:o.filter(t=>t.estimatedMinutes<=2),quick:o.filter(t=>t.estimatedMinutes>2&&t.estimatedMinutes<=15),focused:o.filter(t=>t.estimatedMinutes>15&&t.estimatedMinutes<=60),deep:o.filter(t=>t.estimatedMinutes>60)}}const G="zenflow_tasks",H="zenflow_task_momentum";function be({onClose:n,onAwardXp:o,onEarnTreats:t}){const{t:a}=Z(),[c,p]=r.useState([]),[m,h]=r.useState(""),[d,g]=r.useState(15),[f,N]=r.useState(!1),[u,z]=r.useState(5),[x,T]=r.useState(0),[y,b]=r.useState(!1),[k,J]=r.useState(!1);r.useEffect(()=>{const s=localStorage.getItem(G);if(s){const i=B(s,[]);p(Array.isArray(i)?i:[])}const l=localStorage.getItem(H);if(l){const i=B(l,{});i.lastCompletion&&Date.now()-i.lastCompletion<30*60*1e3&&T(i.count||0)}J(!0)},[]),r.useEffect(()=>{k&&(localStorage.setItem(G,JSON.stringify(c)),$.sync("tasks",async()=>{await V(c)}).catch(s=>U.error("[TasksPanel] Cloud sync failed:",s)))},[c,k]),r.useEffect(()=>{k&&localStorage.setItem(H,JSON.stringify({count:x,lastCompletion:x>0?Date.now():null}))},[x,k]);const R=r.useMemo(()=>D(c),[c]),A=r.useMemo(()=>de(c),[c]),I=r.useMemo(()=>xe(c),[c]),M=r.useMemo(()=>_(x),[x]),E=r.useCallback(()=>{const s=m.trim();if(!s)return;const l=ee.safeParse(s);if(!l.success){U.warn("[TasksPanel] Invalid task name:",l.error.message);return}const i=se(l.data),w={id:Date.now().toString(),name:i,urgent:f,estimatedMinutes:d,userRating:u,completed:!1};p(C=>[...C,w]),h(""),g(15),N(!1),z(5),b(!1)},[m,d,f,u]),Q=r.useCallback(s=>{p(l=>l.map(i=>{if(i.id!==s)return i;const w=!i.completed;return T(w?C=>{const j=C+1,X=_(j),P=Math.round(15*X.streakMultiplier);return o&&o("task",P),t&&t("task",P,`Task: ${i.name}`),j===3||j===5||j%10===0?te():ae(),j}:0),{...i,completed:w}}))},[o,t]),q=r.useCallback(s=>{p(l=>l.filter(i=>i.id!==s))},[]),S=(s,l)=>{const i=l!==void 0&&l<3;return e.jsx("div",{className:v("p-4 rounded-2xl transition-all duration-300 animate-fade-in",s.completed?"bg-primary/5 opacity-70 scale-95":i?"zen-gradient-card zen-shadow-soft border-2 border-primary/30 hover:zen-shadow":"bg-card border border-border hover:border-primary/30 hover:zen-shadow-soft"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>Q(s.id),className:v("mt-1 flex-shrink-0 transition-colors",s.completed?"text-primary":"text-muted-foreground hover:text-primary"),children:s.completed?e.jsx(re,{className:"w-5 h-5"}):e.jsx(ce,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:v("font-medium min-w-0 truncate",s.completed&&"line-through text-muted-foreground"),children:s.name}),i&&!s.completed&&e.jsxs("span",{className:"flex-shrink-0 px-2 py-1 text-xs font-bold zen-gradient text-white rounded-full",children:["Top ",l+1]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[s.urgent&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-destructive/10 text-destructive rounded-md text-xs font-medium",children:[e.jsx(F,{className:"w-3 h-3"}),a.urgent||"Urgent"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary rounded-md text-xs",children:[e.jsx(L,{className:"w-3 h-3"}),s.estimatedMinutes," ",a.min||"min"]}),s.userRating&&s.userRating>=7&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-500/10 text-yellow-700 dark:text-yellow-400 rounded-md text-xs",children:[e.jsx(oe,{className:"w-3 h-3"}),s.userRating,"/10"]})]}),!s.completed&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:s.reasoning}),e.jsx("p",{className:"text-xs font-medium text-primary",children:s.encouragement})]})]}),e.jsx("button",{onClick:()=>q(s.id),className:"flex-shrink-0 p-1 text-muted-foreground hover:text-destructive transition-colors",children:e.jsx(le,{className:"w-4 h-4"})})]})},s.id)};return e.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"tasks-panel-title",className:"fixed inset-0 z-[60] bg-background/95 backdrop-blur-sm overflow-y-auto",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{id:"tasks-panel-title",className:"text-2xl font-bold zen-text-gradient",children:a.taskMomentum||"Task Momentum"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.taskMomentumDesc||"ADHD-friendly task prioritization"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>b(!y),className:v("p-3 rounded-xl transition-all zen-shadow-soft",y?"bg-muted text-foreground":"zen-gradient text-white hover:opacity-90"),children:e.jsx(Y,{className:"w-5 h-5"})}),n&&e.jsx("button",{onClick:n,"aria-label":a.close||"Close",className:"p-3 rounded-xl bg-muted hover:bg-muted/80 transition-colors",children:e.jsx(ne,{className:"w-5 h-5"})})]})]}),x>0&&e.jsx("div",{className:"p-4 zen-gradient rounded-xl zen-shadow animate-scale-in",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-4xl",children:"ðŸ”¥"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-white font-bold",children:M.message}),e.jsxs("div",{className:"text-white/80 text-sm mt-1",children:[x," ",a.tasksInARow||"tasks in a row"," â€¢ +",Math.round(15*M.streakMultiplier)," XP â€¢ ",M.streakMultiplier,"x"]})]})]})}),y&&e.jsxs("div",{className:"p-4 bg-card rounded-2xl border-2 border-primary/30 zen-shadow-card animate-scale-in space-y-4",children:[e.jsx("input",{type:"text",value:m,onChange:s=>h(s.target.value),placeholder:a.taskNamePlaceholder||"Task name...",className:"w-full p-3 bg-secondary rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30",autoFocus:!0,onKeyDown:s=>s.key==="Enter"&&E()}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:a.durationMinutes||"Duration (minutes)"}),e.jsx("input",{type:"number",value:d,onChange:s=>g(O(s.target.value,15,1,480)),min:"1",max:"480",className:"w-full p-2 bg-secondary rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:a.interestLevel||"Interest (1-10)"}),e.jsx("input",{type:"number",value:u,onChange:s=>z(O(s.target.value,5,1,10)),min:"1",max:"10",className:"w-full p-2 bg-secondary rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30"})]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:f,onChange:s=>N(s.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm text-foreground",children:a.markAsUrgent||"Mark as urgent"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:E,disabled:!m.trim(),className:"flex-1 py-3 zen-gradient text-white rounded-xl font-medium hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:a.addTask||"Add Task"}),e.jsx("button",{onClick:()=>b(!1),className:"px-6 py-3 bg-secondary text-secondary-foreground rounded-xl font-medium hover:bg-muted transition-colors",children:a.cancel||"Cancel"})]})]}),A.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(F,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:a.topRecommendedTasks||"Top 3 Recommended Tasks"})]}),e.jsx("div",{className:"space-y-3",children:A.map((s,l)=>S(s,l))})]}),I.immediate.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(L,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:a.quickWins||"Quick Wins (Under 2 min)"})]}),e.jsx("div",{className:"space-y-2",children:I.immediate.map(s=>S(s))})]}),R.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:a.allTasks||"All Tasks"}),e.jsx("div",{className:"space-y-2",children:R.map(s=>S(s))})]}),c.length===0&&!y&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-primary/10 rounded-2xl flex items-center justify-center",children:e.jsx(ie,{className:"w-8 h-8 text-primary"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:a.noTasksYet||"No tasks yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:a.addFirstTaskMessage||"Add your first task to get started with Task Momentum!"}),e.jsxs("button",{onClick:()=>b(!0),className:"px-6 py-3 zen-gradient text-white rounded-xl font-medium hover:opacity-90 transition-opacity inline-flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5"}),a.addFirstTask||"Add Your First Task"]})]}),e.jsx("div",{className:"p-4 bg-primary/5 border border-primary/20 rounded-xl",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ’¡"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:a.adhdTaskTips||"ADHD Task Tips"}),e.jsxs("ul",{className:"text-muted-foreground space-y-1 list-disc list-inside",children:[e.jsx("li",{children:a.taskTip1||"Start with quick wins (2-5 min tasks)"}),e.jsx("li",{children:a.taskTip2||"Build momentum with consecutive completions"}),e.jsx("li",{children:a.taskTip3||"High interest tasks give more dopamine"}),e.jsx("li",{children:a.taskTip4||"Urgent + short = perfect combo"})]})]})]})})]})})}export{be as TasksPanel};
