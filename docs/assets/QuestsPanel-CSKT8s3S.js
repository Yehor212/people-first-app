import{j as e}from"./ui-vendor-KfDTkiq1.js";import{r}from"./react-vendor-IF54zLUS.js";import{u as S,a5 as z,b2 as C,l as D,b3 as n,b4 as y,b5 as j,b6 as f,X as P,y as R,i as B,a6 as A,S as b,g as m,b7 as L,b8 as W,T as N,b9 as I}from"./index-UwLtZcXk.js";import"./charts-PQtVkfgh.js";import"./backend-CX_x5MVl.js";import"./animations-CRFQTM8M.js";const w="zenflow_quests";function H({onClose:g}){const{t}=S(),[i,x]=r.useState(null),[d,u]=r.useState(null),[a,o]=r.useState(null),[c,v]=r.useState(!1);r.useEffect(()=>{const s=localStorage.getItem(w);if(s){const l=z(s,{});x(l.daily||null),u(l.weekly||null),o(l.bonus||null)}v(!0)},[]),r.useEffect(()=>{if(!c)return;const s={daily:i,weekly:d,bonus:a};localStorage.setItem(w,JSON.stringify(s)),C(s).catch(l=>D.error("Failed to push quests to cloud:",l))},[i,d,a,c]),r.useEffect(()=>{c&&((!i||n(i))&&x(y()),(!d||n(d))&&u(j()),!a&&Math.random()<.2?o(f()):a&&n(a)&&o(null))},[c]);const Q=()=>{x(y())},k=()=>{u(j())},T=()=>{(!a||n(a))&&o(f())},E=s=>({daily:t.dailyQuest,weekly:t.weeklyQuest,bonus:t.bonusQuest})[s]||t.questType,p=s=>{if(!s)return e.jsx("div",{className:"p-6 bg-muted/50 rounded-xl border-2 border-dashed border-border text-center",children:e.jsx("p",{className:"text-muted-foreground",children:t.noQuestAvailable})});const l=s.progress/s.total*100,h=Date.now()>s.expiresAt;return e.jsxs("div",{className:m("p-6 rounded-xl border-2 transition-all",s.completed?"bg-primary/10 border-primary/50 zen-shadow":h?"bg-muted/50 border-border opacity-60":s.type==="bonus"?"zen-gradient-card border-yellow-500/50 zen-shadow-xl":"bg-card border-border hover:border-primary/30 zen-shadow-soft"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3 gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:L(s.category)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:m("font-bold line-clamp-2",W(s.type),s.completed&&"line-through opacity-70"),children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:E(s.type)})]})]}),s.completed&&e.jsx(N,{className:"w-6 h-6 text-primary"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:s.description}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsxs("span",{className:"font-medium",children:[t.questProgress," ",s.progress,"/",s.total]}),e.jsx("span",{className:m("font-medium",h?"text-destructive":"text-primary"),children:h?t.questExpired:I(s)})]}),e.jsx("div",{className:"h-2 bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:m("h-full transition-all duration-500",s.completed?"bg-primary":s.type==="bonus"?"zen-gradient":"bg-primary"),style:{width:`${l}%`}})})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-primary/10 text-primary rounded-md font-medium",children:[e.jsx(b,{className:"w-4 h-4"}),"+",s.reward.xp," XP"]}),s.reward.badge&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-500/10 text-yellow-700 dark:text-yellow-400 rounded-md font-medium",children:[e.jsx(N,{className:"w-4 h-4"}),s.reward.badge]})]})}),s.completed&&e.jsx("div",{className:"mt-4 p-3 bg-primary/5 border border-primary/20 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-primary",children:["âœ¨ ",s.reward.message]})})]})};return e.jsx("div",{role:"dialog","aria-modal":"true","aria-labelledby":"quests-title",className:"fixed inset-0 z-[60] bg-background/95 backdrop-blur-sm overflow-y-auto",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{id:"quests-title",className:"text-2xl font-bold zen-text-gradient",children:t.randomQuests}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.questsPanelSubtitle})]}),g&&e.jsx("button",{onClick:g,"aria-label":t.close||"Close",className:"p-3 rounded-xl bg-muted hover:bg-muted/80 transition-colors",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 zen-gradient rounded-xl zen-shadow",children:e.jsxs("div",{className:"flex items-start gap-3 text-white",children:[e.jsx(R,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium mb-1",children:["ðŸŽ¯ ",t.adhdEngagementSystem]}),e.jsx("div",{className:"text-white/90",children:t.adhdEngagementDesc})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:t.dailyQuest})]}),e.jsx("button",{onClick:Q,className:"text-sm px-3 py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-lg transition-colors",children:t.newQuest})]}),p(i)]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:t.weeklyQuest})]}),e.jsx("button",{onClick:k,className:"text-sm px-3 py-1 bg-primary/10 hover:bg-primary/20 text-primary rounded-lg transition-colors",children:t.newQuest})]}),p(d)]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-yellow-500"}),e.jsx("h3",{className:"text-lg font-semibold",children:t.bonusQuest}),e.jsx("span",{className:"px-2 py-0.5 bg-yellow-500/10 text-yellow-700 dark:text-yellow-400 text-xs font-medium rounded-full",children:t.limitedTime})]}),(!a||n(a))&&e.jsx("button",{onClick:T,className:"text-sm px-3 py-1 zen-gradient text-white rounded-lg hover:opacity-90 transition-opacity",children:t.generate})]}),a?p(a):e.jsxs("div",{className:"p-8 bg-muted/50 rounded-xl border-2 border-dashed border-border text-center",children:[e.jsx(b,{className:"w-12 h-12 mx-auto mb-3 text-yellow-500/50"}),e.jsx("p",{className:"text-muted-foreground mb-3",children:t.noBonusQuestAvailable}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.bonusQuestsHint})]})]}),e.jsx("div",{className:"p-4 bg-primary/5 border border-primary/20 rounded-xl",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ’¡"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium mb-1",children:t.questTips}),e.jsxs("ul",{className:"text-muted-foreground space-y-1 list-disc list-inside",children:[e.jsx("li",{children:t.questTipDaily}),e.jsx("li",{children:t.questTipWeekly}),e.jsx("li",{children:t.questTipBonus}),e.jsx("li",{children:t.questTipExpire})]})]})]})})]})})}export{H as QuestsPanel};
