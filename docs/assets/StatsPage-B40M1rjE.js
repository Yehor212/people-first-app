import{j as e}from"./ui-vendor-KfDTkiq1.js";import{r as p}from"./react-vendor-IF54zLUS.js";import{c as jt,u as ie,X as at,S as fe,L as Ge,a as ot,D as vt,C as Nt,F as Ye,b as _e,d as wt,l as xe,f as rt,_ as kt,T as Dt,e as le,g as F,h as St,i as nt,j as Mt,k as it,H as lt,E as Ct,A as Le,m as dt,s as he,n as Ie,o as Pe,p as Z,q as Tt,r as Ft,t as At,P as $t,v as Ue,w as ct,x as mt,M as ut,y as Et,B as Rt,z as He,G as Ne,I as Wt,J as Lt,K as It,N as Ve,O as Me,Q as Ce,R as Ht,U as Kt,V as Pt,W as Bt}from"./index-UwLtZcXk.js";import{R as Te,L as Ot,C as Fe,X as Ae,Y as $e,T as Ee,a as zt,B as Je,b as qe}from"./charts-PQtVkfgh.js";import"./backend-CX_x5MVl.js";import"./animations-CRFQTM8M.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=jt("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),Xe=async()=>(await kt(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).default;function Yt({stats:s,onClose:o}){const{t:a}=ie(),i=p.useRef(null),[d,l]=p.useState(!1),[n,t]=p.useState(null),c="square",f=async()=>{if(i.current)try{l(!0);const u=await(await Xe())(i.current,{backgroundColor:null,scale:2}),x=await new Promise(N=>{u.toBlob(S=>N(S),"image/png")});if(Nt.isNativePlatform())try{const N=await new Promise(E=>{const $=new FileReader;$.readAsDataURL(x),$.onloadend=()=>{const R=$.result.split(",")[1];E(R)}}),S=`zenflow-share-${Date.now()}.png`,A=await Ye.writeFile({path:S,data:N,directory:_e.Cache});await wt.share({title:a.shareTitle||"My ZenFlow Progress",text:`${s.currentStreak} day streak! ðŸ”¥`,files:[A.uri],dialogTitle:a.shareDialogTitle});try{await Ye.deleteFile({path:S,directory:_e.Cache})}catch(E){xe.warn("[ShareProgress] Failed to cleanup cached file:",E)}}catch(N){xe.error("[ShareProgress] Native share failed:",N),t(a.shareFailed);return}else if(navigator.share&&navigator.canShare){const N=new File([x],"zenflow-progress.png",{type:"image/png"});await navigator.share({title:a.shareTitle||"My ZenFlow Progress",text:`${s.currentStreak} day streak! ðŸ”¥`,files:[N]})}else g(x);o()}catch(m){xe.error("Share failed:",m),t(a.shareFailed)}finally{l(!1)}},g=async m=>{if(i.current){l(!0);try{let h=m;if(!h){const A=await(await Xe())(i.current,{backgroundColor:null,scale:2});h=await new Promise(E=>{A.toBlob($=>E($),"image/png")})}const u=URL.createObjectURL(h),x=document.createElement("a");x.href=u,x.download=`zenflow-${c}-${rt(new Date)}.png`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(u)}catch(h){xe.error("Download failed:",h)}finally{l(!1)}}},y=s.totalHabits>0?Math.round(s.habitsCompleted/s.totalHabits*100):0,w=s.currentStreak>=30?{emoji:"ðŸ‘‘",text:a.shareAchievement30,subtext:a.shareSubtext30}:s.currentStreak>=14?{emoji:"ðŸ’Ž",text:a.shareAchievement14,subtext:a.shareSubtext14}:s.currentStreak>=7?{emoji:"ðŸ”¥",text:a.shareAchievement7,subtext:a.shareSubtext7}:s.currentStreak>=3?{emoji:"â­",text:a.shareAchievement3,subtext:a.shareSubtext3}:{emoji:"ðŸŒ±",text:a.shareAchievementStart,subtext:a.shareSubtextStart};return e.jsxs("div",{role:"dialog","aria-modal":"true","aria-label":a.shareTitle||"Share Progress",className:"fixed inset-0 bg-black/80 backdrop-blur-md z-[60] flex items-center justify-center p-4 pt-safe pb-safe animate-fade-in",children:[e.jsx("button",{onClick:o,"aria-label":a.close||"Close",className:"absolute top-4 right-4 p-2 bg-white/10 hover:bg-white/20 rounded-full transition-colors z-10",children:e.jsx(at,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"w-full max-w-sm",children:[e.jsxs("div",{ref:i,className:"relative overflow-hidden aspect-square",style:{background:"linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%)",borderRadius:"24px"},children:[e.jsx("div",{className:"absolute top-[-20%] right-[-20%] w-[60%] h-[60%] rounded-full opacity-40",style:{background:"radial-gradient(circle, #4ade80 0%, transparent 70%)"}}),e.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-[50%] h-[50%] rounded-full opacity-30",style:{background:"radial-gradient(circle, #22d3ee 0%, transparent 70%)"}}),e.jsx("div",{className:"absolute top-[40%] left-[60%] w-[40%] h-[40%] rounded-full opacity-20",style:{background:"radial-gradient(circle, #a78bfa 0%, transparent 70%)"}}),e.jsxs("div",{className:"relative z-10 h-full flex flex-col p-6 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-auto",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"linear-gradient(135deg, #4ade80, #22d3ee)"},children:e.jsx(fe,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"ZenFlow"}),e.jsx("p",{className:"text-xs text-white/60",children:"Wellness Journey"})]})]}),e.jsxs("div",{className:"text-center my-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:w.emoji}),e.jsx("h2",{className:"font-black text-3xl mb-2",style:{background:"linear-gradient(135deg, #4ade80, #22d3ee, #a78bfa)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:w.text}),e.jsx("p",{className:"text-white/60 text-sm",children:w.subtext})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur rounded-2xl p-4 border border-white/10",children:[e.jsx("div",{className:"text-3xl font-black mb-1",style:{background:"linear-gradient(135deg, #f97316, #ef4444)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:s.currentStreak}),e.jsx("div",{className:"text-xs text-white/50 uppercase tracking-wider",children:a.streakDays||"Day Streak"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur rounded-2xl p-4 border border-white/10",children:[e.jsxs("div",{className:"text-3xl font-black mb-1",style:{background:"linear-gradient(135deg, #4ade80, #22c55e)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:[y,"%"]}),e.jsx("div",{className:"text-xs text-white/50 uppercase tracking-wider",children:a.habitsToday||"Habits Done"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur rounded-2xl p-4 border border-white/10",children:[e.jsx("div",{className:"text-3xl font-black mb-1",style:{background:"linear-gradient(135deg, #22d3ee, #3b82f6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:s.focusMinutes}),e.jsx("div",{className:"text-xs text-white/50 uppercase tracking-wider",children:a.focusMinutes||"Focus Min"})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur rounded-2xl p-4 border border-white/10",children:[e.jsx("div",{className:"text-3xl font-black mb-1",style:{background:"linear-gradient(135deg, #a78bfa, #ec4899)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:s.level}),e.jsx("div",{className:"text-xs text-white/50 uppercase tracking-wider",children:a.level||"Level"})]})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("p",{className:"text-xs text-white/40",children:"zenflow.app"})})]})]}),n&&e.jsxs("div",{className:"mt-3 p-3 bg-red-500/20 border border-red-500/30 rounded-xl text-center animate-fade-in",children:[e.jsx("p",{className:"text-red-400 text-sm",children:n}),e.jsx("button",{onClick:()=>t(null),className:"mt-2 text-xs text-red-300 underline",children:a.dismiss})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsx("button",{onClick:()=>{t(null),f()},disabled:d,className:"flex-1 py-4 rounded-2xl font-semibold flex items-center justify-center gap-2 transition-all disabled:opacity-50",style:{background:"linear-gradient(135deg, #4ade80, #22d3ee)"},children:d?e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"w-5 h-5 animate-spin"}),a.generating||"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ot,{className:"w-5 h-5"}),a.shareButton||"Share"]})}),e.jsx("button",{onClick:()=>g(),disabled:d,className:"py-4 px-6 bg-white/10 hover:bg-white/20 text-white rounded-2xl font-semibold flex items-center justify-center gap-2 transition-all disabled:opacity-50",children:d?e.jsx(Ge,{className:"w-5 h-5 animate-spin"}):e.jsx(vt,{className:"w-5 h-5"})})]})]})]})}function Re({type:s,value:o,label:a,sublabel:i,suffix:d="",delay:l=0}){const[n,t]=p.useState(0),[c,f]=p.useState(!1),[g,y]=p.useState(!1),j=p.useRef(null);p.useEffect(()=>{const u=setTimeout(()=>{if(y(!0),o>0){f(!0);const x=1500,N=Math.min(o,60),S=x/N;let A=0;const E=setInterval(()=>{A++;const $=A/N,V=1-Math.pow(1-$,3);t(Math.round(V*o)),A>=N&&(clearInterval(E),t(o),setTimeout(()=>f(!1),500))},S);return()=>clearInterval(E)}},l);return()=>clearTimeout(u)},[o,l]);const m={streak:{icon:St,gradient:"from-orange-500 via-red-500 to-yellow-500",bgGlow:"shadow-orange-500/30",iconAnimation:"animate-flame-flicker",progressColor:"bg-gradient-to-r from-orange-500 to-red-500"},focus:{icon:nt,gradient:"from-violet-500 via-purple-500 to-indigo-500",bgGlow:"shadow-violet-500/30",iconAnimation:"animate-pulse",progressColor:"bg-gradient-to-r from-violet-500 to-purple-500"},habits:{icon:Mt,gradient:"from-emerald-500 via-green-500 to-teal-500",bgGlow:"shadow-emerald-500/30",iconAnimation:"animate-bounce-check",progressColor:"bg-gradient-to-r from-emerald-500 to-green-500"}}[s],h=m.icon;return e.jsxs("div",{ref:j,className:F("relative overflow-hidden rounded-2xl p-5 transition-all duration-500","bg-gradient-to-br from-secondary/80 to-secondary",g?"opacity-100 translate-y-0":"opacity-0 translate-y-8",c&&"scale-[1.02]"),style:{transitionDelay:`${l}ms`},children:[e.jsx("div",{className:F("absolute inset-0 opacity-0 transition-opacity duration-500 blur-xl",`bg-gradient-to-br ${m.gradient}`,c&&"opacity-20")}),e.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:F("w-14 h-14 rounded-xl flex items-center justify-center transition-all duration-300",`bg-gradient-to-br ${m.gradient}`,c&&`shadow-lg ${m.bgGlow}`),children:e.jsx(h,{className:F("w-7 h-7 text-white transition-transform",c&&m.iconAnimation)})}),c&&e.jsx("div",{className:"absolute inset-0 rounded-xl animate-ping-slow",children:e.jsx("div",{className:F("w-full h-full rounded-xl opacity-30",`bg-gradient-to-br ${m.gradient}`)})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a}),e.jsx("p",{className:"text-xs text-muted-foreground/70",children:i})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:F("text-3xl font-black transition-all duration-300","bg-clip-text text-transparent",`bg-gradient-to-r ${m.gradient}`,c&&"scale-110"),children:[n,d&&e.jsx("span",{className:"text-lg ml-1",children:d})]})})]}),e.jsxs("div",{className:"relative mt-4 h-1.5 bg-secondary/50 rounded-full overflow-hidden",children:[e.jsx("div",{className:F("absolute inset-y-0 left-0 rounded-full transition-all duration-1000 ease-out",m.progressColor),style:{width:g?`${Math.min(100,n/Math.max(o,1)*100)}%`:"0%",transitionDelay:`${l+200}ms`}}),c&&e.jsx("div",{className:"absolute inset-0 animate-shimmer-slide overflow-hidden",children:e.jsx("div",{className:"h-full w-1/3 bg-gradient-to-r from-transparent via-white/40 to-transparent"})})]})]})}function _t({currentStreak:s,totalFocusMinutes:o,habitsCompleted:a,streakLabel:i,streakSublabel:d,focusLabel:l,focusSublabel:n,habitsLabel:t,habitsSublabel:c,focusSuffix:f,title:g,onShare:y}){return e.jsxs("div",{className:"bg-card rounded-2xl p-6 zen-shadow-card overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-amber-500 to-orange-500 rounded-xl shadow-lg shadow-amber-500/20",children:e.jsx(Dt,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("div",{className:"absolute -bottom-1 -left-1 w-1.5 h-1.5 bg-amber-400 rounded-full animate-pulse delay-300"})]}),e.jsx("h3",{className:"text-lg font-bold text-foreground flex-1",children:g}),y&&e.jsx("button",{onClick:y,className:"p-2.5 bg-gradient-to-br from-primary to-accent rounded-xl text-white shadow-lg shadow-primary/20 hover:scale-105 transition-transform",children:e.jsx(le,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Re,{type:"streak",value:s,label:i,sublabel:d,delay:0}),e.jsx(Re,{type:"focus",value:o,label:l,sublabel:n,suffix:f,delay:150}),e.jsx(Re,{type:"habits",value:a,label:t,sublabel:c,delay:300})]})]})}const Ut={joy:{gradient:"from-yellow-400 to-amber-500",bgLight:"bg-yellow-500/20"},trust:{gradient:"from-green-400 to-emerald-500",bgLight:"bg-green-500/20"},fear:{gradient:"from-teal-400 to-cyan-500",bgLight:"bg-teal-500/20"},surprise:{gradient:"from-blue-400 to-sky-500",bgLight:"bg-blue-500/20"},sadness:{gradient:"from-indigo-400 to-blue-500",bgLight:"bg-indigo-500/20"},disgust:{gradient:"from-purple-400 to-violet-500",bgLight:"bg-purple-500/20"},anger:{gradient:"from-red-400 to-rose-500",bgLight:"bg-red-500/20"},anticipation:{gradient:"from-orange-400 to-amber-500",bgLight:"bg-orange-500/20"}};function Vt({emotionCounts:s,totalEmotions:o,title:a,language:i,allTags:d,selectedTag:l,onTagChange:n,tagFilterLabel:t,allTagsLabel:c}){const{t:f}=ie(),[g,y]=p.useState({joy:0,trust:0,fear:0,surprise:0,sadness:0,disgust:0,anger:0,anticipation:0}),[j,w]=p.useState(!1);return p.useMemo(()=>it(i),[i]),p.useEffect(()=>{w(!0);const m=setTimeout(()=>{y(s)},300);return()=>clearTimeout(m)},[s]),e.jsxs("div",{className:F("bg-card rounded-2xl p-6 zen-shadow-card overflow-hidden transition-all duration-500",j?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-pink-500 to-rose-500 rounded-xl shadow-lg shadow-pink-500/20",children:e.jsx(lt,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-pink-400 rounded-full animate-pulse"})]}),e.jsx("h3",{className:"text-lg font-bold text-foreground flex-1",children:a}),o>0&&e.jsx("div",{className:"px-3 py-1 bg-secondary rounded-full",children:e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:o})})]}),d&&d.length>0&&n&&e.jsxs("div",{className:"mb-5",children:[e.jsx("label",{className:"text-sm text-muted-foreground mb-2 block",children:t}),e.jsxs("select",{value:l,onChange:m=>n(m.target.value),className:"w-full p-3 bg-secondary rounded-xl text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30 transition-all",children:[e.jsx("option",{value:"all",children:c}),d.map(m=>e.jsx("option",{value:m,children:m},m))]})]}),e.jsx("div",{className:"space-y-3",children:Ct.map((m,h)=>{const u=g[m]||0,x=o>0?u/o*100:0,N=Ut[m];return e.jsx("div",{className:"group animate-fade-in",style:{animationDelay:`${h*80}ms`},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:F("w-10 h-10 rounded-xl flex items-center justify-center transition-all duration-300",N.bgLight,"group-hover:scale-110 group-hover:shadow-lg"),children:e.jsx(Le,{emotion:m,size:"sm"})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"h-3.5 bg-secondary/80 rounded-full overflow-hidden relative",children:[e.jsx("div",{className:F("h-full rounded-full transition-all duration-1000 ease-out relative",`bg-gradient-to-r ${N.gradient}`),style:{width:`${x}%`,transitionDelay:`${h*100}ms`},children:x>0&&e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 animate-shimmer-slide",children:e.jsx("div",{className:"h-full w-1/3 bg-gradient-to-r from-transparent via-white/30 to-transparent"})})})}),x>20&&e.jsxs("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-[9px] font-bold text-white/90",children:[Math.round(x),"%"]})]})}),e.jsx("div",{className:F("min-w-[2.5rem] text-right transition-all duration-300","group-hover:scale-110"),children:e.jsx("span",{className:F("text-base font-bold bg-clip-text text-transparent",`bg-gradient-to-r ${N.gradient}`),children:u})})]})},m)})}),o===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(fe,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:f.noEmotionDataYet||"No emotion data yet"})]})]})}const Jt={terrible:1,bad:2,okay:3,good:4,great:5};function qt({moods:s,habits:o,focusSessions:a}){const{t:i,language:d}=ie(),l=dt(d),[n,t]=p.useState("30"),c=p.useMemo(()=>{const j=parseInt(n),w=new Date,m=[];for(let h=j-1;h>=0;h--){const u=new Date(w);u.setDate(u.getDate()-h);const x=u.toISOString().split("T")[0],N=s.filter(S=>S.date===x);if(N.length>0){const S=N.reduce((A,E)=>A+Jt[E.mood],0)/N.length;m.push({date:x,value:S,label:u.toLocaleDateString(l,{month:"short",day:"numeric"})})}else m.push({date:x,value:0,label:u.toLocaleDateString(l,{month:"short",day:"numeric"})})}return m},[s,n,l]),f=p.useMemo(()=>{const j=parseInt(n),w=new Date,m=[];for(let h=j-1;h>=0;h--){const u=new Date(w);u.setDate(u.getDate()-h);const x=u.toISOString().split("T")[0],N=o.filter(E=>E.completedDates?.includes(x)).length,S=o.length,A=S>0?N/S*100:0;m.push({date:x,rate:A,label:u.toLocaleDateString(l,{month:"short",day:"numeric"})})}return m},[o,n,l]),g=p.useMemo(()=>{const j=parseInt(n),w=new Date,m=[];for(let h=j-1;h>=0;h--){const u=new Date(w);u.setDate(u.getDate()-h);const x=u.toISOString().split("T")[0],N=a.filter(S=>S.date===x&&S.status!=="aborted").reduce((S,A)=>S+(A.duration||0),0);m.push({date:x,minutes:N,label:u.toLocaleDateString(l,{month:"short",day:"numeric"})})}return m},[a,n,l]),y=p.useMemo(()=>{const j=c.filter(x=>x.value>0),w=he(j.map(x=>x.value)),m=he(f.map(x=>x.rate)),h=g.reduce((x,N)=>x+N.minutes,0),u=he(g.map(x=>x.minutes));return{avgMood:w.toFixed(1),avgHabitRate:Math.round(m),totalFocusMinutes:h,avgFocusMinutes:Math.round(u)}},[c,f,g]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:i.trendsTitle||"Your Trends"}),e.jsx("div",{className:"flex gap-2",role:"group","aria-label":i.trendsTimeRange||"Time range",children:["7","30","90"].map(j=>e.jsxs("button",{onClick:()=>t(j),"aria-pressed":n===j,className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${n===j?"bg-primary text-primary-foreground":"bg-secondary text-muted-foreground hover:bg-secondary/80"}`,children:[j,"d"]},j))})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 bg-card border border-border rounded-xl",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:i.trendsAvgMood||"Avg Mood"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:y.avgMood}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"/5"})]}),e.jsxs("div",{className:"p-3 bg-card border border-border rounded-xl",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:i.trendsHabitRate||"Habit Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[y.avgHabitRate,"%"]})]}),e.jsxs("div",{className:"p-3 bg-card border border-border rounded-xl",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:i.trendsFocusTime||"Focus"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:y.avgFocusMinutes}),e.jsx("div",{className:"text-xs text-muted-foreground",children:i.minPerDay||"min/day"})]})]}),e.jsxs("div",{className:"bg-card rounded-2xl p-4 zen-shadow-card border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(le,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-semibold text-foreground",children:i.trendsMoodChart||"Mood Over Time"})]}),e.jsx("div",{role:"img","aria-label":i.trendsMoodChart||"Mood Over Time",children:e.jsx(Te,{width:"100%",height:200,children:e.jsxs(Ot,{data:c,children:[e.jsx(Fe,{strokeDasharray:"3 3",stroke:"#333",opacity:.1}),e.jsx(Ae,{dataKey:"label",tick:{fontSize:10},interval:n==="7"?0:n==="30"?5:14}),e.jsx($e,{domain:[0,5],ticks:[1,2,3,4,5],tick:{fontSize:10}}),e.jsx(Ee,{contentStyle:{backgroundColor:"rgba(0,0,0,0.8)",border:"none",borderRadius:"8px",fontSize:"12px"}}),e.jsx(zt,{type:"monotone",dataKey:"value",stroke:"#8b5cf6",strokeWidth:2,dot:{r:3},activeDot:{r:5}})]})})})]}),e.jsxs("div",{className:"bg-card rounded-2xl p-4 zen-shadow-card border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ie,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"font-semibold text-foreground",children:i.trendsHabitChart||"Habit Completion"})]}),e.jsx("div",{role:"img","aria-label":i.trendsHabitChart||"Habit Completion",children:e.jsx(Te,{width:"100%",height:200,children:e.jsxs(Je,{data:f,children:[e.jsx(Fe,{strokeDasharray:"3 3",stroke:"#333",opacity:.1}),e.jsx(Ae,{dataKey:"label",tick:{fontSize:10},interval:n==="7"?0:n==="30"?5:14}),e.jsx($e,{domain:[0,100],tick:{fontSize:10}}),e.jsx(Ee,{contentStyle:{backgroundColor:"rgba(0,0,0,0.8)",border:"none",borderRadius:"8px",fontSize:"12px"}}),e.jsx(qe,{dataKey:"rate",fill:"#22c55e",radius:[4,4,0,0]})]})})})]}),e.jsxs("div",{className:"bg-card rounded-2xl p-4 zen-shadow-card border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(nt,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-foreground",children:i.trendsFocusChart||"Focus Time"})]}),e.jsx("div",{role:"img","aria-label":i.trendsFocusChart||"Focus Time",children:e.jsx(Te,{width:"100%",height:200,children:e.jsxs(Je,{data:g,children:[e.jsx(Fe,{strokeDasharray:"3 3",stroke:"#333",opacity:.1}),e.jsx(Ae,{dataKey:"label",tick:{fontSize:10},interval:n==="7"?0:n==="30"?5:14}),e.jsx($e,{tick:{fontSize:10}}),e.jsx(Ee,{contentStyle:{backgroundColor:"rgba(0,0,0,0.8)",border:"none",borderRadius:"8px",fontSize:"12px"}}),e.jsx(qe,{dataKey:"minutes",fill:"#3b82f6",radius:[4,4,0,0]})]})})}),e.jsxs("div",{className:"mt-3 text-center text-sm text-muted-foreground",children:[i.trendsTotalFocus||"Total",": ",y.totalFocusMinutes," ",i.minutes||"minutes"]})]}),e.jsx("div",{className:"p-4 bg-primary/10 rounded-xl border border-primary/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pe,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:i.trendsInsightHint||"Want personalized insights?"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.trendsInsightHintDesc||"Check the Insights panel on the home tab to discover patterns in your data."})]})]})})]})}const Ze=["bg-secondary","bg-emerald-200 dark:bg-emerald-900","bg-emerald-400 dark:bg-emerald-700","bg-emerald-500 dark:bg-emerald-500","bg-emerald-600 dark:bg-emerald-400"],Xt=["S","M","T","W","T","F","S"],Zt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Qt({data:s,months:o=3,className:a,labels:i}){const{weeks:d,monthLabels:l}=p.useMemo(()=>{const n=new Date,t=new Date(n),c=new Date(n);c.setMonth(c.getMonth()-o+1),c.setDate(1);const f=c.getDay();c.setDate(c.getDate()-f);const g=new Map;s.forEach(x=>g.set(x.date,x.level));const y=[];let j=[];const w=[];let m=-1;const h=new Date(c);let u=0;for(;h<=t;){const x=h.toISOString().split("T")[0],N=h.getMonth(),S=h.getDate();if(N!==m&&S<=7){const A=i.monthNames||Zt;w.push({label:A[N],weekIndex:u}),m=N}j.push({date:x,level:g.get(x)||0,day:h.getDay()}),j.length===7&&(y.push(j),j=[],u++),h.setDate(h.getDate()+1)}return j.length>0&&y.push(j),{weeks:y,monthLabels:w}},[s,o,i.monthNames]);return e.jsxs("div",{className:F("bg-card rounded-2xl p-4 zen-shadow-card",a),children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-4",children:i.title}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("div",{className:"inline-flex flex-col gap-1 min-w-max",children:[e.jsx("div",{className:"flex ml-7",children:l.map((n,t)=>e.jsx("div",{className:"text-[10px] text-muted-foreground",style:{position:"relative",left:`${n.weekIndex*12}px`,marginRight:t<l.length-1?`${(l[t+1]?.weekIndex-n.weekIndex-3)*12}px`:0},children:n.label},t))}),e.jsxs("div",{className:"flex gap-[2px]",children:[e.jsx("div",{className:"flex flex-col gap-[2px] mr-1 justify-center",children:(i.dayNames||Xt).map((n,t)=>e.jsx("div",{className:F("w-3 h-[10px] text-[8px] text-muted-foreground text-right",t%2===0?"opacity-100":"opacity-0"),children:n},t))}),d.map((n,t)=>e.jsx("div",{className:"flex flex-col gap-[2px]",children:n.map((c,f)=>e.jsx("div",{className:F("w-[10px] h-[10px] rounded-[2px] transition-colors",Ze[c.level],c.date>new Date().toISOString().split("T")[0]&&"opacity-30"),title:`${c.date}: Level ${c.level}`},`${t}-${f}`))},t))]}),e.jsxs("div",{className:"flex items-center justify-end gap-1 mt-2 text-[10px] text-muted-foreground",children:[e.jsx("span",{children:i.less}),Ze.map((n,t)=>e.jsx("div",{className:F("w-[10px] h-[10px] rounded-[2px]",n)},t)),e.jsx("span",{children:i.more})]})]})})]})}function es(s,o){let a=0;return o.hasMood&&(a+=1),o.hasFocus&&(a+=1),o.hasGratitude&&(a+=1),o.habitsTotal>0&&o.habitsCompleted>=o.habitsTotal?a+=1:o.habitsCompleted>0&&(a+=.5),a>=3.5?4:a>=2.5?3:a>=1.5?2:a>0?1:0}function ts({total:s,current:o,progress:a}){return e.jsx("div",{className:"flex gap-1 px-4 pt-4",children:Array.from({length:s}).map((i,d)=>e.jsx("div",{className:"flex-1 h-0.5 bg-white/30 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-white rounded-full transition-all duration-100",style:{width:d<o?"100%":d===o?`${a}%`:"0%"}})},d))})}function ss({slide:s}){return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-6xl mb-6 animate-bounce-slow",children:s.icon}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:s.title}),e.jsx("p",{className:"text-xl opacity-80",children:s.subtitle})]})}function as({slide:s,t:o}){const a=s.data,i=["ðŸ˜¢","ðŸ˜”","ðŸ˜","ðŸ™‚","ðŸ˜„"];return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-7xl mb-4",children:s.icon}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:s.title}),e.jsx("p",{className:"text-lg opacity-80 mb-6",children:s.subtitle}),e.jsx("div",{className:"flex gap-2 mb-4",children:i.map((d,l)=>e.jsx("div",{className:F("w-10 h-10 rounded-full flex items-center justify-center text-xl transition-all",Math.round(a?.average||3)===l+1?"bg-white/30 scale-125":"bg-white/10"),children:d},l))}),e.jsx("div",{className:"text-5xl font-black",children:s.value}),e.jsx("p",{className:"text-sm opacity-60 mt-2",children:o.storyAverageMoodScore||"average mood score"})]})}function os({slide:s,t:o}){const a=s.data;return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-7xl mb-4",children:s.icon}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:s.title}),e.jsx("div",{className:"text-7xl font-black mb-2",children:s.value}),e.jsx("p",{className:"text-lg opacity-80 mb-6",children:o.storyCompletionRate||"completion rate"}),a?.topHabit&&e.jsxs("div",{className:"bg-white/10 rounded-2xl px-6 py-4",children:[e.jsx("p",{className:"text-sm opacity-60 mb-1",children:o.storyTopHabit||"Top habit"}),e.jsxs("p",{className:"text-xl font-semibold",children:[a.topHabit.icon," ",a.topHabit.name]}),e.jsxs("p",{className:"text-sm opacity-80",children:[a.topHabit.completions," ",o.storyCompletions||"completions"]})]}),a?.perfectDays>0&&e.jsxs("p",{className:"mt-4 text-sm opacity-80",children:["â­ ",a.perfectDays," ",o.storyPerfectDays||"perfect days this week"]})]})}function rs({slide:s,t:o}){const a=s.data;return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-7xl mb-4",children:s.icon}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:s.title}),e.jsx("div",{className:"text-6xl font-black mb-2",children:s.value}),e.jsx("p",{className:"text-lg opacity-80 mb-6",children:s.subtitle}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full max-w-xs",children:[e.jsxs("div",{className:"bg-white/10 rounded-xl p-4",children:[e.jsxs("p",{className:"text-2xl font-bold",children:[a?.averageSession,"m"]}),e.jsx("p",{className:"text-xs opacity-60",children:o.storyAvgSession||"avg session"})]}),e.jsxs("div",{className:"bg-white/10 rounded-xl p-4",children:[e.jsxs("p",{className:"text-2xl font-bold",children:[a?.longestSession,"m"]}),e.jsx("p",{className:"text-xs opacity-60",children:o.storyLongestSession||"longest"})]})]}),a?.topLabel&&e.jsxs("p",{className:"mt-4 text-sm opacity-80",children:[o.storyMostFocusedOn||"Most focused on:"," ",a.topLabel]})]})}function ns({slide:s}){const o=s.value,a=Math.min(o,7);return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-4xl mb-4 flex",children:"ðŸ”¥".repeat(a)}),e.jsx("div",{className:"text-8xl font-black mb-2",children:o}),e.jsx("h2",{className:"text-2xl font-bold tracking-wide uppercase mb-4",children:"Day Streak"}),e.jsx("p",{className:"text-xl opacity-90",children:s.subtitle})]})}function is({slide:s}){const o=s.data||[];return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-7xl mb-4",children:s.icon}),e.jsx("h2",{className:"text-2xl font-bold mb-6",children:s.title}),e.jsx("div",{className:"flex flex-wrap justify-center gap-4 max-w-xs",children:o.slice(0,4).map(a=>e.jsxs("div",{className:"bg-white/10 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:a.icon}),e.jsx("p",{className:"text-xs opacity-80 line-clamp-2",children:a.title.en})]},a.id))})]})}function Qe({slide:s}){return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-7xl mb-6",children:s.icon}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:s.title}),e.jsx("p",{className:"text-lg opacity-80",children:s.subtitle})]})}function ls({slide:s,t:o}){return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-white text-center px-8",children:[e.jsx("div",{className:"text-7xl mb-6 animate-pulse",children:s.icon}),e.jsx("h1",{className:"text-3xl font-bold mb-2",children:s.title}),e.jsx("p",{className:"text-xl opacity-80",children:s.subtitle}),e.jsxs("div",{className:"mt-12 text-sm opacity-60",children:[e.jsx("p",{children:o.storyTrackYourJourney||"Track your journey with"}),e.jsx("p",{className:"font-semibold text-lg",children:"ZenFlow"})]})]})}function ds({slides:s,onClose:o,weekRange:a,streak:i=0,newBadges:d=[]}){const{t:l,language:n}=ie(),[t,c]=p.useState(0),[f,g]=p.useState(0),[y,j]=p.useState(!1),[w,m]=p.useState(!1),h=p.useRef(null),u=5e3,x=50,N=s[t];p.useEffect(()=>{if(y||w)return;let D=!0;return h.current=setInterval(()=>{D&&g(T=>{const _=T+x/u*100;return _>=100?t<s.length-1?(c(Q=>Q+1),0):(h.current&&(clearInterval(h.current),h.current=null),setTimeout(()=>{D&&o()},0),100):_})},x),()=>{D=!1,h.current&&(clearInterval(h.current),h.current=null)}},[t,y,w,s.length,o]),p.useEffect(()=>{g(0)},[t]);const S=p.useCallback(()=>{Z(),t>0&&(c(D=>D-1),g(0))},[t]),A=p.useCallback(()=>{Z(),t<s.length-1?(c(D=>D+1),g(0)):o()},[t,s.length,o]),E=p.useCallback(()=>{Z(),j(D=>!D)},[]),$=p.useCallback(async()=>{Z(),m(!0),j(!0);try{const D=s.find(Y=>Y.type==="mood"),T=s.find(Y=>Y.type==="habits"),_=s.find(Y=>Y.type==="focus"),Q=D?.data,ee=T?.data,be=_?.data,ae=ee?.totalCompletions||0,ye=ee?.completionRate||0,G=ye>0?Math.round(ae/(ye/100)):ae,O={weekRange:a,moodAverage:Q?.average||0,habitsCompleted:ae,habitsTotal:Math.max(G,ae),focusMinutes:be?.totalMinutes||0,streak:i,newBadges:d},U=await Tt(O,void 0,n);await Ft(U,l.myProgress||"My Weekly Progress",l.shareText||"Check out my progress!")&&At()}catch(D){xe.error("Failed to share:",D)}finally{m(!1)}},[a,i,d,n,l,s]),V=p.useCallback(D=>{const T=D.currentTarget.getBoundingClientRect(),Q=("touches"in D?D.touches[0].clientX:D.clientX)-T.left,ee=T.width;Q<ee*.3?S():Q>ee*.7?A():E()},[S,A,E]),R=()=>{switch(N.type){case"intro":return e.jsx(ss,{slide:N});case"mood":return e.jsx(as,{slide:N,t:l});case"habits":return e.jsx(os,{slide:N,t:l});case"focus":return e.jsx(rs,{slide:N,t:l});case"streak":return e.jsx(ns,{slide:N});case"achievement":return e.jsx(is,{slide:N});case"summary":return e.jsx(Qe,{slide:N});case"outro":return e.jsx(ls,{slide:N,t:l});default:return e.jsx(Qe,{slide:N})}};return e.jsx("div",{role:"dialog","aria-modal":"true","aria-label":l.weeklyStory||"Weekly Story",className:"fixed inset-0 z-[100] bg-black",children:e.jsxs("div",{className:"relative w-full h-full",style:{background:N.gradient},onClick:V,children:[e.jsx(ts,{total:s.length,current:t,progress:f}),e.jsxs("div",{className:"absolute top-8 left-0 right-0 flex items-center justify-between px-4 z-10",children:[e.jsx("button",{onClick:D=>{D.stopPropagation(),Z(),o()},className:"p-2 rounded-full bg-black/20 text-white","aria-label":l.close||"Close",children:e.jsx(at,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:D=>{D.stopPropagation(),E()},className:"p-2 rounded-full bg-black/20 text-white","aria-label":y?l.play||"Play":l.pause||"Pause",children:y?e.jsx($t,{className:"w-5 h-5"}):e.jsx(Ue,{className:"w-5 h-5"})}),e.jsx("button",{onClick:D=>{D.stopPropagation(),$()},disabled:w,className:"p-2 rounded-full bg-black/20 text-white","aria-label":l.shareButton||"Share",children:e.jsx(ot,{className:F("w-5 h-5",w&&"animate-pulse")})})]})]}),e.jsx("div",{className:"absolute inset-0 pt-20 pb-16",children:R()}),e.jsxs("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center gap-4 text-white/40 text-xs",children:[e.jsx("span",{children:l.storyTapLeft||"â† Tap left"}),e.jsx("span",{children:l.storyTapCenter||"Tap center to pause"}),e.jsx("span",{children:l.storyTapRight||"Tap right â†’"})]}),y&&!w&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:e.jsx("div",{className:"bg-white/20 rounded-full p-4",children:e.jsx(Ue,{className:"w-12 h-12 text-white"})})})]})})}const X={intro:{gradient:"linear-gradient(135deg, #1E293B 0%, #334155 100%)",accent:"#94A3B8"},mood:{gradient:"linear-gradient(135deg, #7C3AED 0%, #A78BFA 100%)",accent:"#C4B5FD"},habits:{gradient:"linear-gradient(135deg, #059669 0%, #10B981 100%)",accent:"#6EE7B7"},focus:{gradient:"linear-gradient(135deg, #2563EB 0%, #3B82F6 100%)",accent:"#93C5FD"},gratitude:{gradient:"linear-gradient(135deg, #DB2777 0%, #EC4899 100%)",accent:"#F9A8D4"},streak:{gradient:"linear-gradient(135deg, #EA580C 0%, #F97316 100%)",accent:"#FDBA74"},achievement:{gradient:"linear-gradient(135deg, #CA8A04 0%, #EAB308 100%)",accent:"#FDE047"},summary:{gradient:"linear-gradient(135deg, #0891B2 0%, #06B6D4 100%)",accent:"#67E8F9"},outro:{gradient:"linear-gradient(135deg, #4F46E5 0%, #6366F1 100%)",accent:"#A5B4FC"}};function Be(){const s=new Date,o=s.getDay(),a=o===0?-6:1-o,i=new Date(s);i.setDate(s.getDate()+a),i.setHours(0,0,0,0);const d=new Date(i);d.setDate(i.getDate()+6),d.setHours(23,59,59,999);const l=t=>t.toLocaleDateString("en-US",{month:"short",day:"numeric"}),n=`${l(i)} - ${l(d)}`;return{start:i,end:d,range:n}}function ge(s,o,a){const i=o.toISOString().split("T")[0],d=a.toISOString().split("T")[0];return s.filter(l=>l.date>=i&&l.date<=d)}function cs(s){const o={great:5,good:4,okay:3,bad:2,terrible:1},a={great:0,good:0,okay:0,bad:0,terrible:0};let i=0,d="",l="",n=0,t=6;s.forEach(u=>{const x=o[u.mood]||3;i+=x,a[u.mood]=(a[u.mood]||0)+1,x>n&&(n=x,d=u.date),x<t&&(t=x,l=u.date)});const c=s.length>0?i/s.length:0,f=Object.entries(a).reduce((u,x)=>x[1]>u[1]?x:u,["okay",0])[0],g=Math.floor(s.length/2),y=s.slice(0,g),j=s.slice(g),w=y.reduce((u,x)=>u+(o[x.mood]||3),0)/(y.length||1),m=j.reduce((u,x)=>u+(o[x.mood]||3),0)/(j.length||1);let h="stable";return m-w>.3?h="up":w-m>.3&&(h="down"),{average:c,trend:h,bestDay:d,worstDay:l,dominantMood:f,moodCounts:a}}function ms(s,o,a){let i=0,d=0,l=null,n=0;const t=o.toISOString().split("T")[0],c=a.toISOString().split("T")[0],f=[],g=new Date(o);for(;g<=a;)f.push(g.toISOString().split("T")[0]),g.setDate(g.getDate()+1);const y=new Map;s.forEach(m=>{const h=(m.completedDates||[]).filter(u=>u>=t&&u<=c);i+=h.length,d+=f.length,h.length>n&&(n=h.length,l={name:m.name,icon:m.icon,completions:h.length}),h.forEach(u=>{y.set(u,(y.get(u)||0)+1)})});const j=f.filter(m=>(y.get(m)||0)>=s.length&&s.length>0).length,w=d>0?i/d*100:0;return{totalCompletions:i,completionRate:w,topHabit:l,perfectDays:j}}function us(s){const o=s.filter(f=>f.status!=="aborted"),a=o.reduce((f,g)=>f+g.duration,0),i=o.length,d=i>0?Math.round(a/i):0,l=o.reduce((f,g)=>Math.max(f,g.duration),0),n=new Map;o.forEach(f=>{f.label&&n.set(f.label,(n.get(f.label)||0)+1)});let t=null,c=0;return n.forEach((f,g)=>{f>c&&(c=f,t=g)}),{totalMinutes:a,sessionsCount:i,averageSession:d,longestSession:l,topLabel:t}}function xs(s,o,a,i,d=[],l=0,n={}){const{start:t,end:c,range:f}=Be(),g=ge(s,t,c),y=ge(a,t,c),j=ge(i,t,c),w=cs(g),m=ms(o,t,c),h=us(y),u=[];if(u.push({type:"intro",title:n.weeklyReview||"Your Week in Review",subtitle:f,icon:"ðŸ“Š",...X.intro}),g.length>0){const N={great:"ðŸ˜„",good:"ðŸ™‚",okay:"ðŸ˜",bad:"ðŸ˜”",terrible:"ðŸ˜¢"}[w.dominantMood]||"ðŸ™‚",S={up:n.moodTrendUp||"Improving! â†—ï¸",down:n.moodTrendDown||"Challenging week â†˜ï¸",stable:n.moodTrendStable||"Steady week â†’"}[w.trend];u.push({type:"mood",title:n.moodJourney||"Mood Journey",subtitle:S,icon:N,value:`${w.average.toFixed(1)}/5`,data:w,...X.mood})}if(o.length>0&&m.totalCompletions>0&&u.push({type:"habits",title:n.habitChampions||"Habit Champions",subtitle:m.topHabit?`${m.topHabit.icon} ${m.topHabit.name}`:void 0,icon:"ðŸŽ¯",value:`${Math.round(m.completionRate)}%`,data:m,...X.habits}),h.sessionsCount>0){const N=Math.floor(h.totalMinutes/60),S=h.totalMinutes%60,A=N>0?`${N}h ${S}m`:`${S}m`;u.push({type:"focus",title:n.deepWork||"Deep Work",subtitle:`${h.sessionsCount} ${n.sessions||"sessions"}`,icon:"ðŸ§ ",value:A,data:h,...X.focus})}if(j.length>0&&u.push({type:"gratitude",title:n.gratitudeMoments||"Gratitude Moments",subtitle:n.thingsToBeThankfulFor||"Things to be thankful for",icon:"ðŸ’–",value:j.length,data:j.slice(0,3),...X.gratitude}),l>0){const N=l>=30?n.legendaryStreak||"Legendary! ðŸ‘‘":l>=14?n.amazingStreak||"Amazing! ðŸ’Ž":l>=7?n.onFire||"On Fire! ðŸ”¥":n.keepGoing||"Keep Going!";u.push({type:"streak",title:`${l} ${n.dayStreak||"Day Streak"}`,subtitle:N,icon:"ðŸ”¥",value:l,...X.streak})}d.length>0&&u.push({type:"achievement",title:n.achievementsUnlocked||"Achievements Unlocked",subtitle:`${d.length} ${n.newBadges||"new"}`,icon:"ðŸ†",value:d.length,data:d,...X.achievement});const x=[];return g.length>0&&x.push(`${w.average.toFixed(1)} avg mood`),m.totalCompletions>0&&x.push(`${m.totalCompletions} habits`),h.totalMinutes>0&&x.push(`${h.totalMinutes}m focus`),x.length>0&&u.push({type:"summary",title:n.weekSummary||"Week Summary",subtitle:x.join(" â€¢ "),icon:"âœ¨",data:{moodStats:w,habitStats:m,focusStats:h},...X.summary}),u.push({type:"outro",title:n.keepGrowing||"Keep Growing!",subtitle:n.seeYouNextWeek||"See you next week",icon:"ðŸŒ±",...X.outro}),u}function hs(s,o,a){const{start:i,end:d}=Be(),l=ge(s,i,d),n=ge(a,i,d);return l.length>=2||o.length>0||n.length>0}const gs={terrible:1,bad:2,okay:3,good:4,great:5},ps=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Ke(s){const o=new Date(s),a=o.getDay(),i=a===0?-6:1-a,d=new Date(o);d.setDate(o.getDate()+i),d.setHours(0,0,0,0);const l=new Date(d);return l.setDate(d.getDate()+6),l.setHours(23,59,59,999),{start:d,end:l}}function ne(s){return s.toISOString().split("T")[0]}function fs(s){const o=new Date(s);o.setHours(0,0,0,0),o.setDate(o.getDate()+4-(o.getDay()||7));const a=new Date(o.getFullYear(),0,1);return Math.ceil(((o.getTime()-a.getTime())/864e5+1)/7)}function pe(s,o,a){const i=ne(o),d=ne(a);return s.filter(l=>l.date>=i&&l.date<=d)}function et(s){return gs[s]||3}function tt(s,o,a,i,d,l){const n=ne(s),t=ne(o),c=pe(a,s,o),f=pe(d,s,o).filter(R=>R.status!=="aborted"),g=pe(l,s,o),y=c.map(R=>et(R.mood)),j=he(y),w=new Map;c.forEach(R=>{const D=w.get(R.date)||[];D.push(et(R.mood)),w.set(R.date,D)});let m=null,h=null,u=0,x=6;w.forEach((R,D)=>{const T=he(R);T>u&&(u=T,m=D),T<x&&(x=T,h=D)});const N=[],S=new Date(s);for(;S<=o;)N.push(ne(S)),S.setDate(S.getDate()+1);let A=0,E=0,$=0;i.forEach(R=>{const D=(R.completedDates||[]).filter(T=>T>=n&&T<=t);A+=D.length,E+=N.length});for(const R of N)i.some(T=>T.completedDates?.includes(R))?$++:$=0;const V=f.reduce((R,D)=>R+D.duration,0);return{weekStart:n,weekEnd:t,moodAverage:Math.round(j*10)/10,moodCount:c.length,habitsCompleted:A,habitsTotal:E,habitCompletionRate:E>0?Math.round(A/E*100):0,focusMinutes:V,focusSessions:f.length,gratitudeCount:g.length,streakDays:$,bestDay:m,worstDay:h}}function bs(s,o){const a=o.moodAverage>0?(s.moodAverage-o.moodAverage)/o.moodAverage*100:0,i=o.habitCompletionRate>0?s.habitCompletionRate-o.habitCompletionRate:s.habitCompletionRate,d=o.focusMinutes>0?(s.focusMinutes-o.focusMinutes)/o.focusMinutes*100:0,l=[a>5,i>5,d>10].filter(Boolean).length,n=[a<-5,i<-5,d<-10].filter(Boolean).length;let t="stable";return l>=2?t="improving":n>=2&&(t="declining"),{moodChange:Math.round(a),habitsChange:Math.round(i),focusChange:Math.round(d),trend:t}}function ys(s,o,a,i,d){const l=[];if(s.moodAverage<3&&s.moodCount>=3&&l.push({id:"low-mood-week",type:"mood",priority:"high",title:"Mood needs attention",titleKey:"recLowMoodTitle",description:"Your mood this week has been lower than usual. Consider activities that usually lift your spirits.",descriptionKey:"recLowMoodDesc",action:"Try a quick 5-minute breathing exercise",actionKey:"recLowMoodAction",icon:"ðŸ’™"}),a&&a.habitsChange<-15&&l.push({id:"habit-decline",type:"habit",priority:"high",title:"Habit consistency dropped",titleKey:"recHabitDeclineTitle",description:`Your habit completion is down ${Math.abs(a.habitsChange)}% from last week. Start small to rebuild momentum.`,descriptionKey:"recHabitDeclineDesc",action:"Focus on just one habit today",actionKey:"recHabitDeclineAction",icon:"ðŸŽ¯"}),s.focusMinutes<60&&s.focusSessions<3&&l.push({id:"low-focus",type:"focus",priority:"medium",title:"Boost your focus time",titleKey:"recLowFocusTitle",description:"You've had limited focus sessions this week. Even short sessions help build the habit.",descriptionKey:"recLowFocusDesc",action:"Try a 10-minute focus session",actionKey:"recLowFocusAction",icon:"ðŸ§ "}),a&&a.trend==="improving"&&l.push({id:"great-progress",type:"general",priority:"low",title:"You're on a roll! ðŸŽ‰",titleKey:"recGreatProgressTitle",description:"Your overall progress is improving compared to last week. Keep up the momentum!",descriptionKey:"recGreatProgressDesc",icon:"â­"}),s.bestDay){const t=ps[new Date(s.bestDay).getDay()];l.push({id:"best-day",type:"mood",priority:"low",title:`${t} was your best day`,titleKey:"recBestDayTitle",description:"Try to identify what made this day special and replicate those conditions.",descriptionKey:"recBestDayDesc",icon:"â˜€ï¸"})}if(s.gratitudeCount<3&&l.push({id:"more-gratitude",type:"general",priority:"medium",title:"Practice gratitude",titleKey:"recGratitudeTitle",description:"Writing down things you're grateful for can significantly improve your mood over time.",descriptionKey:"recGratitudeDesc",action:"Add a gratitude entry today",actionKey:"recGratitudeAction",icon:"ðŸ’–"}),s.habitCompletionRate>=90&&l.push({id:"perfect-week",type:"habit",priority:"low",title:"Amazing consistency!",titleKey:"recPerfectWeekTitle",description:`You completed ${s.habitCompletionRate}% of your habits this week. You're building strong routines!`,descriptionKey:"recPerfectWeekDesc",icon:"ðŸ†"}),i.length>0&&d.length>7){const t=i.filter(c=>(c.completedDates?.length||0)>=5).sort((c,f)=>(f.completedDates?.length||0)-(c.completedDates?.length||0))[0];t&&l.push({id:"top-habit",type:"habit",priority:"medium",title:`Keep up "${t.name}"`,titleKey:"recTopHabitTitle",description:"This is one of your most consistent habits. It's likely contributing to your well-being.",descriptionKey:"recTopHabitDesc",icon:t.icon})}const n={high:0,medium:1,low:2};return l.sort((t,c)=>n[t.priority]-n[c.priority]),l.slice(0,5)}function js(s,o){const a=[];if(s.moodAverage>=4?a.push(`Great mood week! Average: ${s.moodAverage}/5 âœ¨`):s.moodCount>0&&a.push(`Tracked mood ${s.moodCount} times`),s.habitCompletionRate>=80?a.push(`${s.habitCompletionRate}% habit completion ðŸŽ¯`):s.habitsCompleted>0&&a.push(`${s.habitsCompleted} habits completed`),s.focusMinutes>=120){const i=Math.floor(s.focusMinutes/60),d=s.focusMinutes%60;a.push(`${i}h ${d}m of deep focus ðŸ§ `)}else s.focusMinutes>0&&a.push(`${s.focusMinutes}m focused`);return s.streakDays>=5&&a.push(`${s.streakDays} day streak ðŸ”¥`),o&&(o.moodChange>10&&a.push(`Mood up ${o.moodChange}% from last week ðŸ“ˆ`),o.habitsChange>10&&a.push(`Habits up ${o.habitsChange}% ðŸ“ˆ`),o.focusChange>20&&a.push(`Focus time up ${o.focusChange}% ðŸ“ˆ`)),a.slice(0,4)}function vs(s,o,a,i=[]){const d=new Date,{start:l,end:n}=Ke(d),t=tt(l,n,s,o,a,i),c=new Date(l);c.setDate(c.getDate()-1);const{start:f}=Ke(c),g=tt(f,c,s,o,a,i),y=g.moodCount>0||g.habitsCompleted>0?bs(t,g):null,j=ys(t,g.moodCount>0?g:null,y,o,s),w=js(t,y);return{currentWeek:t,previousWeek:g.moodCount>0||g.habitsCompleted>0?g:null,comparison:y,recommendations:j,highlights:w,weekNumber:fs(d)}}function Ns(s,o,a){const i=new Date,{start:d,end:l}=Ke(i),n=pe(s,d,l),t=pe(a,d,l),c=o.some(f=>f.completedDates?.some(g=>g>=ne(d)&&g<=ne(l)));return n.length>=2||c||t.length>=1}function ws({recommendation:s,t:o,onAction:a}){const i={high:"border-red-500/30 bg-red-500/5 hover:bg-red-500/10",medium:"border-amber-500/30 bg-amber-500/5 hover:bg-amber-500/10",low:"border-emerald-500/30 bg-emerald-500/5 hover:bg-emerald-500/10"},d={habit:e.jsx(Et,{className:"w-4 h-4"}),mood:e.jsx(lt,{className:"w-4 h-4"}),focus:e.jsx(Rt,{className:"w-4 h-4"}),general:e.jsx(ct,{className:"w-4 h-4"})},l=()=>{a&&(Z(),a(s.id))},n=o[s.titleKey]||s.title;return e.jsx("button",{onClick:l,"aria-label":n,className:F("w-full text-left p-3 rounded-xl border transition-all","active:scale-[0.98]",i[s.priority],a&&"cursor-pointer"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-2xl flex-shrink-0","aria-hidden":"true",children:s.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-muted-foreground","aria-hidden":"true",children:d[s.type]}),e.jsx("p",{className:"font-medium text-sm text-foreground truncate",children:n})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:o[s.descriptionKey]||s.description}),s.action&&e.jsxs("p",{className:"text-xs font-medium text-primary mt-2 flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3 h-3","aria-hidden":"true"}),o[s.actionKey]||s.action]})]})]})})}function We({value:s,label:o,suffix:a="%"}){const i=s>0,d=s===0;return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-medium",i&&"bg-emerald-500/10 text-emerald-600",s<0&&"bg-red-500/10 text-red-600",d&&"bg-muted text-muted-foreground"),children:[i?e.jsx(le,{className:"w-3 h-3"}):s<0?e.jsx(mt,{className:"w-3 h-3"}):e.jsx(ut,{className:"w-3 h-3"}),e.jsxs("span",{children:[i&&"+",s,a]})]}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:o})]})}function ks({moods:s,habits:o,focusSessions:a,gratitudeEntries:i=[],className:d,onRecommendationAction:l}){const{t:n}=ie(),[t,c]=p.useState(!1),f=p.useMemo(()=>Ns(s,o,a),[s,o,a]),g=p.useMemo(()=>f?vs(s,o,a,i):null,[s,o,a,i,f]);if(!f||!g)return e.jsx("div",{className:F("bg-card rounded-2xl p-6 zen-shadow-card border border-border",d),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fe,{className:"w-6 h-6 text-primary flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground mb-1",children:n.weeklyInsights||"Weekly Insights"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.weeklyInsightsNotEnoughData||"Track your progress this week to unlock personalized insights and recommendations."})]})]})});const{currentWeek:y,comparison:j,recommendations:w,highlights:m}=g,h={improving:e.jsx(le,{className:"w-4 h-4 text-emerald-500"}),declining:e.jsx(mt,{className:"w-4 h-4 text-red-500"}),stable:e.jsx(ut,{className:"w-4 h-4 text-muted-foreground"})},u=t?w:w.slice(0,2);return e.jsxs("div",{className:F("bg-card rounded-2xl zen-shadow-card border border-border overflow-hidden",d),children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-violet-500/10 to-fuchsia-500/10 border-b border-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-violet-500"}),e.jsx("h3",{className:"font-semibold text-foreground",children:n.weeklyInsights||"Weekly Insights"}),e.jsxs("span",{className:"text-xs bg-violet-500/20 text-violet-600 dark:text-violet-400 px-2 py-0.5 rounded-full font-medium",children:[n.week||"Week"," ",g.weekNumber]})]}),j&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[h[j.trend],e.jsx("span",{className:"capitalize",children:j.trend})]})]}),m.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:m.map((x,N)=>e.jsx("span",{className:"text-xs bg-background/50 px-2 py-1 rounded-lg text-foreground",children:x},N))})]}),j&&e.jsxs("div",{className:"p-4 border-b border-border",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:n.comparedToLastWeek||"Compared to last week"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(We,{value:j.moodChange,label:n.mood||"Mood"}),e.jsx(We,{value:j.habitsChange,label:n.habits||"Habits",suffix:" pts"}),e.jsx(We,{value:j.focusChange,label:n.focus||"Focus"})]})]}),w.length>0&&e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("p",{className:"text-sm font-medium text-foreground flex items-center gap-2",children:[e.jsx(ct,{className:"w-4 h-4 text-amber-500"}),n.recommendations||"Recommendations"]}),w.length>2&&e.jsx("button",{onClick:()=>{Z(),c(!t)},"aria-expanded":t,"aria-label":t?n.showLess||"Show less":n.showMoreRecommendations||"Show more recommendations",className:"text-xs text-primary hover:underline",children:t?n.showLess||"Show less":`${n.showMore||"Show"} ${w.length-2} ${n.more||"more"}`})]}),e.jsx("div",{className:"space-y-2",children:u.map(x=>e.jsx(ws,{recommendation:x,t:n,onAction:l},x.id))})]}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 bg-muted/50 rounded-xl",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-foreground",children:y.moodAverage>0?y.moodAverage:"-"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:n.avgMood||"Avg Mood"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-bold text-foreground",children:[y.habitCompletionRate,"%"]}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:n.habits||"Habits"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-lg font-bold text-foreground",children:[y.focusMinutes,"m"]}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:n.focus||"Focus"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-foreground",children:y.streakDays}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:n.streak||"Streak"})]})]})})]})}const Ds={great:"bg-mood-great",good:"bg-mood-good",okay:"bg-mood-okay",bad:"bg-mood-bad",terrible:"bg-mood-terrible"},Ss=p.memo(function({moods:o,habits:a}){const{t:i}=ie(),d=[i.sun,i.mon,i.tue,i.wed,i.thu,i.fri,i.sat],l=p.useMemo(()=>new Map(o.map(c=>[c.date,c])),[o]),n=p.useMemo(()=>{const c=new Map;return a.forEach(f=>{f.completedDates.forEach(g=>{c.set(g,(c.get(g)||0)+1)})}),c},[a]),t=p.useMemo(()=>{const c=new Date,f=He(),g=[];for(let y=6;y>=0;y--){const j=new Date(c);j.setDate(j.getDate()-y);const w=rt(j),m=l.get(w),h=n.get(w)||0;g.push({date:w,dayName:d[j.getDay()],dayNum:j.getDate(),isToday:w===f,mood:m?.mood,completedHabits:h})}return g},[l,n,d]);return e.jsxs("div",{className:"bg-card rounded-2xl p-3 sm:p-6 zen-shadow-card animate-fade-in",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-3 sm:mb-4",children:i.thisWeek}),e.jsx("div",{className:"grid grid-cols-7 gap-1 sm:gap-2",children:t.map(c=>e.jsxs("div",{className:F("flex flex-col items-center p-1 sm:p-2 rounded-lg sm:rounded-xl transition-all",c.isToday?"bg-primary/10 ring-2 ring-primary":"hover:bg-secondary"),children:[e.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground mb-0.5 sm:mb-1",children:c.dayName.slice(0,2)}),e.jsx("span",{className:F("text-sm sm:text-lg font-semibold mb-1 sm:mb-2",c.isToday?"text-primary":"text-foreground"),children:c.dayNum}),c.mood?e.jsx("div",{className:F("w-4 h-4 sm:w-6 sm:h-6 rounded-full mb-0.5 sm:mb-1",Ds[c.mood])}):e.jsx("div",{className:"w-4 h-4 sm:w-6 sm:h-6 rounded-full bg-secondary mb-0.5 sm:mb-1"}),e.jsx("div",{className:"flex gap-0.5",children:a.slice(0,3).map(f=>e.jsx("div",{className:F("w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full",f.completedDates.includes(c.date)?f.color:"bg-secondary")},f.id))})]},c.date))})]})}),st={great:"ðŸ˜„",good:"ðŸ™‚",okay:"ðŸ˜",bad:"ðŸ˜”",terrible:"ðŸ˜¢"},Es=p.memo(function({moods:o,habits:a,focusSessions:i,gratitudeEntries:d,restDays:l=[],currentFocusMinutes:n}){const{t,language:c}=ie(),[f,g]=p.useState("all"),[y,j]=p.useState("month"),w=He(),[m,h]=p.useState(()=>new Date().getFullYear()),[u,x]=p.useState(()=>new Date().getMonth()),[N,S]=p.useState(!1),[A,E]=p.useState(!1),[$,V]=p.useState(w),[R,D]=p.useState(!1),T=p.useMemo(()=>i.filter(r=>r.status!=="aborted"),[i]),_=[t.january,t.february,t.march,t.april,t.may,t.june,t.july,t.august,t.september,t.october,t.november,t.december],Q=_.map(r=>r?.slice(0,3)||r),ee={great:t.great,good:t.good,okay:t.okay,bad:t.bad,terrible:t.terrible},be=r=>{if(r.emotion?.primary)return Bt(r.emotion.primary,r.emotion.intensity);switch(r.mood){case"great":return 5;case"good":return 4;case"okay":return 3;case"bad":return 2;case"terrible":return 1;default:return 0}},ae=p.useMemo(()=>it(t.locale||"en"),[t.locale]),ye=p.useMemo(()=>{const r=new Set;return o.forEach(b=>(b.tags||[]).forEach(v=>r.add(v))),Array.from(r).sort()},[o]),G=p.useMemo(()=>{const r=new Date,b=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`,v=new Date(r);v.setDate(r.getDate()-6),v.setHours(0,0,0,0);let M=o;return y==="month"?M=o.filter(C=>C.date.startsWith(b)):y==="week"&&(M=o.filter(C=>new Date(C.date)>=v)),f==="all"?M:M.filter(C=>C.tags?.includes(f))},[o,f,y]),O=p.useMemo(()=>{const r=new Set(G.map(k=>k.date)),b=T.filter(k=>y==="all"||r.has(k.date)).reduce((k,B)=>k+B.duration,0),M=T.reduce((k,B)=>k+B.duration,0)+(n||0),C=a.reduce((k,B)=>{const ue=Ne(B).filter(yt=>y==="all"||r.has(yt)).length;return k+ue},0),W=[...o.map(k=>k.date),...a.flatMap(k=>Ne(k)),...T.map(k=>k.date),...d.map(k=>k.date),...l],H=[...new Set(W)].sort(),L=Wt(H),z=G.reduce((k,B)=>(k[B.mood]=(k[B.mood]||0)+1,k),{}),q=G.reduce((k,B)=>{if(B.emotion?.primary)k[B.emotion.primary]=(k[B.emotion.primary]||0)+1;else if(B.mood){const ue=Lt[B.mood];ue&&(k[ue]=(k[ue]||0)+1)}return k},{}),ce=Object.values(q).reduce((k,B)=>k+B,0),I=new Date,P=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`,J=He(),se=o.filter(k=>k.date.startsWith(P)),me=T.filter(k=>k.date.startsWith(P)),De=d.filter(k=>k.date.startsWith(P)),Se=me.reduce((k,B)=>k+B.duration,0),ve=n!==void 0&&J.startsWith(P)?n:Se;return{totalFocusMinutes:b,allTimeFocusMinutes:M,totalHabitCompletions:C,currentStreak:L,moodCounts:z,emotionCounts:q,totalEmotionEntries:ce,thisMonthMoods:se.length,thisMonthFocusMinutes:ve,thisMonthGratitude:De.length,monthName:_[I.getMonth()]}},[o,a,T,d,_,G,y,n]),U=p.useMemo(()=>{if(G.length===0)return{bestDay:null,focusAvg:null,habitDiffs:[]};const r={};G.forEach(I=>{const P=new Date(I.date).getDay(),J=be(I),se=r[P]||{total:0,count:0};se.total+=J,se.count+=1,r[P]=se});const b=[t.sun,t.mon,t.tue,t.wed,t.thu,t.fri,t.sat];let v=null;Object.entries(r).forEach(([I,P])=>{if(!P.count)return;const J=P.total/P.count;(!v||J>v.avg)&&(v={day:b[Ce(I,0,0,6)]||"",avg:J})});const M=new Map(G.map(I=>[I.date,be(I)])),C=new Set(T.map(I=>I.date));let W=0,H=0,L=0,z=0;M.forEach((I,P)=>{C.has(P)?(W+=I,H+=1):(L+=I,z+=1)});const q=H+z>0?{withFocus:H?W/H:0,withoutFocus:z?L/z:0}:null,ce=a.map(I=>{let P=0,J=0,se=0,me=0;M.forEach((ve,k)=>{It(I,k)?(P+=ve,J+=1):(se+=ve,me+=1)});const De=J?P/J:0,Se=me?se/me:0;return{id:I.id,name:I.name,diff:De-Se}}).filter(I=>I.diff>0).sort((I,P)=>P.diff-I.diff).slice(0,3);return{bestDay:v,focusAvg:q,habitDiffs:ce}},[G,a,T,t]),we=p.useMemo(()=>{const r=new Map;return o.forEach(b=>{const v=r.get(b.date)||[];v.push(b),r.set(b.date,v)}),r.forEach(b=>{b.sort((v,M)=>v.timestamp-M.timestamp)}),r},[o]),Y=p.useMemo(()=>{const r=new Map;return o.forEach(b=>{const v=r.get(b.date);(!v||b.timestamp>v.timestamp)&&r.set(b.date,b)}),r},[o]),oe=p.useMemo(()=>{const r=new Map;return T.forEach(b=>{r.set(b.date,(r.get(b.date)||0)+b.duration)}),r},[T]),te=p.useMemo(()=>{const r=new Map;return d.forEach(b=>{const v=r.get(b.date)||[];v.push(b),r.set(b.date,v)}),r},[d]),re=p.useMemo(()=>{const r=new Map;return a.forEach(b=>{Ne(b).forEach(v=>{const M=r.get(v)||[];M.push(b.name),r.set(v,M)})}),r},[a]),xt=p.useMemo(()=>{const r=new Set,b=new Date().getFullYear(),v=C=>{const W=Ce(C.split("-")[0],b,2e3,2100);r.add(W)};[...Y.keys()].forEach(v),[...oe.keys()].forEach(v),[...te.keys()].forEach(v),[...re.keys()].forEach(v),r.add(b),r.add(m);const M=Array.from(r).sort((C,W)=>W-C);return M.length>0?M:[b]},[Y,oe,te,re,m]),je=p.useMemo(()=>{const r=`${m}-`;let b=0,v=0,M=0,C=0;return Y.forEach((W,H)=>{H.startsWith(r)&&(b+=1)}),oe.forEach((W,H)=>{H.startsWith(r)&&(v+=W)}),re.forEach((W,H)=>{H.startsWith(r)&&(M+=W.length)}),te.forEach((W,H)=>{H.startsWith(r)&&(C+=W.length)}),{moodCount:b,focusMinutes:v,habitCompletions:M,gratitudeCount:C}},[m,Y,oe,re,te]),ht=p.useMemo(()=>{const r=Ve(m,u),b=new Date(m,u,1).getDay(),v=`${m}-${String(u+1).padStart(2,"0")}`,M=[];for(let C=0;C<b;C+=1)M.push({});for(let C=1;C<=r;C+=1){const W=`${v}-${String(C).padStart(2,"0")}`;M.push({dateKey:W,day:C})}return M},[m,u]),K=p.useMemo(()=>$?{moods:we.get($)||[],mood:Y.get($),focusMinutes:oe.get($)||0,habits:re.get($)||[],gratitude:te.get($)||[]}:null,[$,we,Y,oe,re,te]),gt=r=>{if(!r)return"";const b=new Date(r).getHours();return b<12?t.morning||"Morning":b<18?t.afternoon||"Afternoon":t.evening||"Evening"},pt=r=>{if(!r)return"ðŸ“";const b=new Date(r).getHours();return b<12?"ðŸŒ…":b<18?"â˜€ï¸":"ðŸŒ™"};p.useMemo(()=>{const r=new Date,b=r.getFullYear(),v=r.getMonth(),M=Ve(b,v),C=`${b}-${String(v+1).padStart(2,"0")}`,W=new Map(G.map(H=>[H.date,H.mood]));return Array.from({length:M},(H,L)=>{const z=L+1,q=`${C}-${String(z).padStart(2,"0")}`;return{dateKey:q,day:z,mood:W.get(q)}})},[G]);const ft=p.useMemo(()=>{const r=new Set(o.map(L=>L.date)),b=new Set(T.map(L=>L.date)),v=new Set(d.map(L=>L.date)),M=new Set,C=new Date,W=new Date;W.setMonth(W.getMonth()-3),[...r,...b,...v].forEach(L=>{const z=new Date(L);z>=W&&z<=C&&M.add(L)});const H=new Date(W);for(;H<=C;)M.add(H.toISOString().split("T")[0]),H.setDate(H.getDate()+1);return Array.from(M).map(L=>{const z=a.filter(ce=>Ne(ce).includes(L)).length,q=es(L,{hasMood:r.has(L),habitsCompleted:z,habitsTotal:a.length,hasFocus:b.has(L),hasGratitude:v.has(L)});return{date:L,level:q}}).sort((L,z)=>L.date.localeCompare(z.date))},[o,a,T,d]),de=a.length>0?a.reduce((r,b)=>Me(r)>Me(b)?r:b):null,Oe=r=>{V(null),x(b=>{const v=b+r;return v<0?(h(M=>M-1),11):v>11?(h(M=>M+1),0):v})},ke=p.useMemo(()=>hs(o,a,i),[o,a,i]),ze=p.useMemo(()=>ke?xs(o,a,i,d,[],O.currentStreak,t):[],[o,a,i,d,O.currentStreak,ke,t]),bt=p.useMemo(()=>Be().range,[]);return e.jsxs("div",{className:"space-y-4 animate-fade-in content-with-nav px-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-foreground",children:t.statistics}),ke&&e.jsxs("button",{onClick:()=>{Z(),E(!0)},"aria-label":t.weeklyStory||"Weekly Story",className:"flex items-center gap-2 px-3 py-2 bg-gradient-to-r from-violet-500 to-fuchsia-500 text-white text-sm font-medium rounded-xl hover:opacity-90 transition-all zen-shadow-soft",children:[e.jsx(Gt,{className:"w-4 h-4"}),t.weeklyStory||"Weekly Story"]})]}),e.jsx(Ss,{moods:o,habits:a}),e.jsxs("div",{className:"bg-card rounded-2xl p-4 sm:p-6 zen-shadow-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 zen-gradient rounded-xl",children:e.jsx(Ie,{className:"w-5 h-5 text-primary-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:O.monthName})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",role:"group","aria-label":t.statsRange||"Statistics range",children:[e.jsx("button",{onClick:()=>j("week"),"aria-pressed":y==="week",className:`px-3 py-2 rounded-lg text-xs font-medium transition-colors ${y==="week"?"bg-primary/10 ring-2 ring-primary text-foreground":"bg-secondary text-muted-foreground hover:bg-muted"}`,children:t.statsRangeWeek}),e.jsx("button",{onClick:()=>j("month"),"aria-pressed":y==="month",className:`px-3 py-2 rounded-lg text-xs font-medium transition-colors ${y==="month"?"bg-primary/10 ring-2 ring-primary text-foreground":"bg-secondary text-muted-foreground hover:bg-muted"}`,children:t.statsRangeMonth}),e.jsx("button",{onClick:()=>j("all"),"aria-pressed":y==="all",className:`px-3 py-2 rounded-lg text-xs font-medium transition-colors ${y==="all"?"bg-primary/10 ring-2 ring-primary text-foreground":"bg-secondary text-muted-foreground hover:bg-muted"}`,children:t.statsRangeAll})]}),e.jsxs("div",{className:"grid grid-cols-2 xs:grid-cols-3 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"text-center p-2 sm:p-3 bg-secondary rounded-xl",children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-primary",children:O.thisMonthMoods}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground truncate",children:t.moodEntries})]}),e.jsxs("div",{className:"text-center p-2 sm:p-3 bg-secondary rounded-xl",children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-accent",children:O.thisMonthFocusMinutes}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground truncate",children:t.focusMinutes})]}),e.jsxs("div",{className:"text-center p-2 sm:p-3 bg-secondary rounded-xl col-span-2 xs:col-span-1",children:[e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-mood-good",children:O.thisMonthGratitude}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground truncate",children:t.gratitudes})]})]})]}),e.jsx(_t,{currentStreak:O.currentStreak,totalFocusMinutes:O.allTimeFocusMinutes,habitsCompleted:O.totalHabitCompletions,streakLabel:t.currentStreak,streakSublabel:t.daysInRow,focusLabel:t.totalFocus,focusSublabel:t.allTime,habitsLabel:t.habitsCompleted,habitsSublabel:t.totalTimes,focusSuffix:t.min,title:t.achievements,onShare:()=>S(!0)}),e.jsx("div",{className:"mb-8",children:e.jsx(qt,{moods:o,habits:a,focusSessions:i})}),e.jsx(Qt,{data:ft,months:3,labels:{title:t.activityHeatmap||"Activity Overview",less:t.less||"Less",more:t.more||"More",monthNames:Q}}),e.jsx(ks,{moods:o,habits:a,focusSessions:T,gratitudeEntries:d,onRecommendationAction:r=>{Z()}}),e.jsx(Vt,{emotionCounts:O.emotionCounts,totalEmotions:G.length,title:t.moodDistribution,language:c,allTags:ye,selectedTag:f,onTagChange:g,tagFilterLabel:t.moodTagFilter,allTagsLabel:t.allTags}),e.jsxs("div",{className:"bg-card rounded-2xl p-3 sm:p-6 zen-shadow-card overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-violet-500 to-purple-500 rounded-xl shadow-lg shadow-violet-500/20",children:e.jsx(Ie,{className:"w-5 h-5 text-white"})}),e.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-violet-400 rounded-full animate-pulse"})]}),e.jsx("h3",{className:"text-lg font-bold text-foreground",children:t.calendarTitle})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-5",children:[e.jsx("label",{className:"text-sm text-muted-foreground",children:t.calendarYear}),e.jsx("select",{value:m,onChange:r=>h(Ce(r.target.value,new Date().getFullYear(),2e3,2100)),className:"p-2 bg-secondary rounded-xl text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30",children:xt.map(r=>e.jsx("option",{value:r,children:r},r))}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Oe(-1),"aria-label":t.calendarPrevMonth,className:"p-2 rounded-xl bg-secondary hover:bg-primary/10 transition-colors",children:e.jsx(Ht,{className:"w-4 h-4"})}),e.jsxs("button",{onClick:()=>D(!R),"aria-expanded":R,"aria-label":t.calendarSelectMonth||"Select month",className:"px-4 py-2 rounded-xl bg-gradient-to-r from-primary/10 to-accent/10 text-sm font-medium hover:from-primary/20 hover:to-accent/20 transition-all flex items-center gap-2",children:[_[u]," ",m,R?e.jsx(Kt,{className:"w-4 h-4"}):e.jsx(Pt,{className:"w-4 h-4"})]}),e.jsx("button",{onClick:()=>Oe(1),"aria-label":t.calendarNextMonth,className:"p-2 rounded-xl bg-secondary hover:bg-primary/10 transition-colors",children:e.jsx(Pe,{className:"w-4 h-4"})})]})]}),R&&e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2 mb-5 animate-fade-in",role:"listbox","aria-label":t.calendarSelectMonth||"Select month",children:_.map((r,b)=>e.jsx("button",{onClick:()=>{x(b),V(null),D(!1)},"aria-selected":u===b,role:"option",className:F("px-2 py-2.5 rounded-xl text-xs font-medium transition-all",u===b?"bg-gradient-to-r from-primary to-accent text-white shadow-lg":"bg-secondary text-muted-foreground hover:bg-primary/10"),children:r},r))}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mb-5",children:[e.jsxs("div",{className:"text-center p-2 sm:p-3 bg-secondary/50 rounded-xl hover:bg-secondary transition-colors",children:[e.jsx("p",{className:"text-lg sm:text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-pink-500 to-rose-500",children:je.moodCount}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:t.moodEntries})]}),e.jsxs("div",{className:"text-center p-2 sm:p-3 bg-secondary/50 rounded-xl hover:bg-secondary transition-colors",children:[e.jsx("p",{className:"text-lg sm:text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-violet-500 to-purple-500",children:je.focusMinutes}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:t.focusMinutes})]}),e.jsxs("div",{className:"text-center p-2 sm:p-3 bg-secondary/50 rounded-xl hover:bg-secondary transition-colors",children:[e.jsx("p",{className:"text-lg sm:text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-emerald-500 to-teal-500",children:je.habitCompletions}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:t.habitsCompleted})]}),e.jsxs("div",{className:"text-center p-2 sm:p-3 bg-secondary/50 rounded-xl hover:bg-secondary transition-colors",children:[e.jsx("p",{className:"text-lg sm:text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-amber-500 to-orange-500",children:je.gratitudeCount}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:t.gratitudes})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-0.5 sm:gap-1 text-[10px] sm:text-xs text-muted-foreground mb-2",children:[t.sun,t.mon,t.tue,t.wed,t.thu,t.fri,t.sat].map(r=>e.jsx("div",{className:"text-center font-medium py-1 sm:py-2",children:r.slice(0,2)},r))}),e.jsx("div",{className:"grid grid-cols-7 gap-0.5 sm:gap-1.5",children:ht.map((r,b)=>{if(!r.dateKey)return e.jsx("div",{className:"w-full aspect-square"},`empty-${b}`);const v=Y.get(r.dateKey)?.mood,M=Y.has(r.dateKey)||oe.has(r.dateKey)||re.has(r.dateKey)||te.has(r.dateKey),C=v==="great"?"from-emerald-400/80 to-teal-500/80":v==="good"?"from-green-400/80 to-emerald-500/80":v==="okay"?"from-amber-400/80 to-yellow-500/80":v==="bad"?"from-orange-400/80 to-amber-500/80":v==="terrible"?"from-red-400/80 to-rose-500/80":"";return e.jsxs("button",{onClick:()=>V(r.dateKey||null),"aria-label":`${r.day} ${_[u]} ${m}${v?`, ${t.mood}: ${t[v]||v}`:""}`,"aria-pressed":r.dateKey===$,className:F("relative w-full aspect-square rounded-xl text-xs font-semibold flex items-center justify-center transition-all duration-200","hover:scale-105 hover:shadow-lg",v?`bg-gradient-to-br ${C} text-white shadow-md`:M?"bg-primary/20 text-foreground":"bg-secondary/50 text-muted-foreground hover:bg-secondary",r.dateKey===w&&"ring-2 ring-primary ring-offset-2 ring-offset-card",r.dateKey===$&&"ring-2 ring-accent ring-offset-1 ring-offset-card scale-110"),children:[e.jsx("span",{children:r.day}),te.has(r.dateKey)&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 text-[8px]",children:"âœ¨"})]},r.dateKey)})}),e.jsx("div",{className:"mt-5 p-4 bg-gradient-to-br from-secondary/80 to-secondary rounded-xl",children:$&&K?e.jsxs("div",{className:"space-y-3 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-bold text-foreground",children:$}),K.mood&&(K.mood.emotion?.primary?e.jsx(Le,{emotion:K.mood.emotion.primary,size:"md"}):e.jsx("span",{className:"text-2xl",children:st[K.mood.mood]}))]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card/50 rounded-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:t.moodToday}),e.jsx("span",{className:"font-medium",children:K.mood?K.mood.emotion?.primary?ae[K.mood.emotion.primary]:ee[K.mood.mood]:"â€”"})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card/50 rounded-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:t.focusMinutes}),e.jsx("span",{className:"font-medium",children:K.focusMinutes})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card/50 rounded-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:t.habitsCompleted}),e.jsx("span",{className:"font-medium",children:K.habits.length})]}),e.jsxs("div",{className:"flex items-center justify-between p-2 bg-card/50 rounded-lg",children:[e.jsx("span",{className:"text-muted-foreground",children:t.gratitudes}),e.jsx("span",{className:"font-medium",children:K.gratitude.length})]})]}),K.moods.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:t.moodNotes||"Mood Notes"}),K.moods.map((r,b)=>e.jsxs("div",{className:"p-3 bg-card/50 rounded-lg border-l-4 border-primary/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.emotion?.primary?e.jsx(Le,{emotion:r.emotion.primary,size:"sm"}):e.jsx("span",{className:"text-lg",children:st[r.mood]}),e.jsx("span",{className:"text-sm font-medium",children:r.emotion?.primary?ae[r.emotion.primary]:ee[r.mood]}),e.jsxs("span",{className:"text-xs text-muted-foreground ml-auto flex items-center gap-1",children:[pt(r.timestamp)," ",gt(r.timestamp)]})]}),r.note&&e.jsxs("p",{className:"text-sm text-foreground mt-2 pl-7 italic",children:['"',r.note,'"']}),r.tags&&r.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2 pl-7",children:r.tags.map(v=>e.jsxs("span",{className:"px-2 py-0.5 bg-primary/10 text-primary text-xs rounded-full",children:["#",v]},v))})]},r.id||`mood-${b}`))]}),K.habits.length>0&&e.jsx("div",{className:"text-xs text-muted-foreground bg-card/30 p-2 rounded-lg",children:K.habits.join(", ")}),K.gratitude.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-xs font-medium text-muted-foreground flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3 text-amber-500"}),t.gratitude||"Gratitude"]}),K.gratitude.map(r=>e.jsx("div",{className:"p-3 bg-gradient-to-r from-amber-500/10 to-orange-500/5 rounded-lg border-l-4 border-amber-500/50",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-base flex-shrink-0",children:"âœ¨"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-foreground",children:r.text}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(r.timestamp).toLocaleTimeString(dt(c),{hour:"2-digit",minute:"2-digit"})})]})]})},r.id))]})]}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:t.calendarSelectDay})})]}),e.jsxs("div",{className:"bg-card rounded-2xl p-3 sm:p-6 zen-shadow-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 zen-gradient rounded-xl",children:e.jsx(le,{className:"w-5 h-5 text-primary-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:t.moodPatternsTitle})]}),G.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:t.moodNoData}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-secondary rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.moodBestDay}),e.jsx("p",{className:"text-sm text-muted-foreground",children:U.bestDay?.day||t.moodNoData})]}),e.jsx("div",{className:"text-xl font-semibold text-foreground",children:U.bestDay?U.bestDay.avg.toFixed(1):"--"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-secondary rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.moodFocusComparison}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.moodFocusWith})]}),e.jsx("div",{className:"text-xl font-semibold text-foreground",children:U.focusAvg?U.focusAvg.withFocus.toFixed(1):"--"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-secondary rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.moodFocusComparison}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.moodFocusWithout})]}),e.jsx("div",{className:"text-xl font-semibold text-foreground",children:U.focusAvg?U.focusAvg.withoutFocus.toFixed(1):"--"})]}),e.jsxs("div",{className:"p-4 bg-secondary rounded-xl",children:[e.jsx("p",{className:"font-medium text-foreground mb-2",children:t.moodHabitCorrelations}),U.habitDiffs.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:t.moodNoData}):e.jsx("div",{className:"space-y-2",children:U.habitDiffs.map(r=>e.jsxs("div",{className:"flex items-center justify-between text-sm text-foreground",children:[e.jsx("span",{children:r.name}),e.jsxs("span",{children:["+",r.diff.toFixed(1)]})]},r.id))})]})]})]}),de&&e.jsxs("div",{className:"bg-card rounded-2xl p-3 sm:p-6 zen-shadow-card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 zen-gradient-warm rounded-xl",children:e.jsx(le,{className:"w-5 h-5 text-primary-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:t.topHabit})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-secondary rounded-xl",children:[e.jsx("div",{className:`w-14 h-14 ${de.color} rounded-xl flex items-center justify-center text-2xl`,children:de.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:de.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.completedTimes," ",Me(de)," ",t.completedTimes2]})]})]})]}),N&&e.jsx(Yt,{stats:{currentStreak:O.currentStreak,habitsCompleted:a.filter(r=>r.completedDates.includes(w)).length,totalHabits:a.length,focusMinutes:O.totalFocusMinutes,level:Math.floor(O.currentStreak/7)+1},onClose:()=>S(!1)}),A&&ze.length>0&&e.jsx(ds,{slides:ze,onClose:()=>E(!1),weekRange:bt,streak:O.currentStreak})]})});export{Es as StatsPage};
